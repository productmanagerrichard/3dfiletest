<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fitz Frames – 3D Viewer</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer@3.4.0/dist/model-viewer.min.js"></script>
  <style>
    :root { --bg:#0e1116; --card:#121720; --text:#e8e8e8; --muted:#9aa4b2; }
    html,body{height:100%;margin:0;background:var(--bg);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--text)}
    .wrap{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;gap:14px;padding:24px;max-width:1100px;margin:0 auto}
    h1{font-size:20px;font-weight:650;margin:0;text-align:center}
    model-viewer{width:100%;height:72vh;background:linear-gradient(180deg,#0f1320,#0b0e16);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .controls{display:flex;gap:16px;flex-wrap:wrap;align-items:center;justify-content:center}
    .group{display:flex;align-items:center;gap:10px;background:var(--card);padding:10px 12px;border-radius:12px;border:1px solid #1e2533}
    .label{font-size:12px;color:var(--muted);margin-right:2px}
    .swatch{width:28px;height:28px;border-radius:999px;border:2px solid rgba(255,255,255,.25);cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.35)}
    .swatch[aria-selected="true"]{outline:2px solid #fff;outline-offset:2px}
    footer{font-size:12px;color:var(--muted);text-align:center;margin-top:2px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Fitz Frames – Brimmer</h1>

    <model-viewer
      id="viewer"
      src="/models/brimmer.glb"
      alt="Fitz Frames – Brimmer"
      camera-controls
      touch-action="pan-y"
      exposure="1"
      environment-image="neutral"
      shadow-intensity="0.4"
      shadow-softness="0.7"
      auto-rotate
      rotation-per-second="25deg">
    </model-viewer>

    <div class="controls">
      <div class="group" id="frameGroup" role="radiogroup" aria-label="Frame color">
        <span class="label">Frame:</span>
        <!-- Existing colors -->
        <button class="swatch" data-hex="#dddddd" aria-label="Light Gray" aria-selected="true" style="background:#dddddd"></button>
        <button class="swatch" data-hex="#cb263a" aria-label="Crimson" style="background:#cb263a"></button>
        <!-- New colors -->
        <button class="swatch" data-hex="#997686" aria-label="Mauve" style="background:#997686"></button>
        <button class="swatch" data-hex="#452e20" aria-label="Brown" style="background:#452e20"></button>
        <button class="swatch" data-hex="#641d37" aria-label="Wine" style="background:#641d37"></button>
        <button class="swatch" data-hex="#2b2d2f" aria-label="Charcoal" style="background:#2b2d2f"></button>
        <button class="swatch" data-hex="#2b3965" aria-label="Navy" style="background:#2b3965"></button>
        <button class="swatch" data-hex="#891c25" aria-label="Deep Red" style="background:#891c25"></button>
      </div>
    </div>

    <footer>Drag to rotate · Two-finger drag to pan · Pinch to zoom</footer>
  </div>

  <script>
    const mv = document.getElementById('viewer');
    const frameGroup = document.getElementById('frameGroup');

    function hexToLinearRGBA(hex){
      const m = /^#?([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(hex);
      if(!m) return [1,1,1,1];
      const srgb = [parseInt(m[1],16), parseInt(m[2],16), parseInt(m[3],16)].map(v=>v/255);
      const toLinear = c => (c <= 0.04045) ? c/12.92 : Math.pow((c+0.055)/1.055, 2.4);
      const lin = srgb.map(toLinear);
      return [lin[0], lin[1], lin[2], 1.0];
    }

    function applyFrameColor(hex){
      const color = hexToLinearRGBA(hex);
      const model = mv.model; if(!model || !color) return;
      for(const mat of model.materials){
        try {
          mat.pbrMetallicRoughness.setBaseColorFactor(color);
        } catch {}
      }
    }

    function selectInGroup(group, el){
      [...group.querySelectorAll('[aria-selected]')].forEach(b=>b.setAttribute('aria-selected','false'));
      el.setAttribute('aria-selected','true');
    }

    mv.addEventListener('load', () => {
      const fSel = frameGroup.querySelector('[aria-selected="true"]');
      if(fSel) applyFrameColor(fSel.dataset.hex);
    });

    frameGroup.addEventListener('click', (e)=>{
      const btn = e.target.closest('.swatch'); if(!btn) return;
      selectInGroup(frameGroup, btn);
      applyFrameColor(btn.dataset.hex);
    });
  </script>
</body>
</html>
